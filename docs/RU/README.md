# Server Tweaker
[![Steam Workshop](https://raw.githubusercontent.com/openzomboid/server-tweaker/master/assets/steam.svg)](https://steamcommunity.com/sharedfiles/filedetails/?id=2951816996)

Server Tweaker содержит осторожные правки, которые не затрагивают значительных механик игры и исправляют некоторые надоевшие баги. В первую очередь мод будет интересным владельцам своих серверов, так как все изменения предназначены улучшения качества жизни в режиме мультиплеер. Server Tweaker разработан для нужд сервера [Last Day](https://last-day.wargm.ru).

## Features
* Запоминание выбора переключателей в меню "Client". Игроки могут настраивать их под себя (в рамках того, что доступно).
* Добавлено кеширование некоторых "тяжелых", часто запрашиваемых данных, что должно положительно сказаться на FPS. На данный момент кеширование используется только самим модом Server Tweaker, но в будущем планируется переключать на кеш и оригинальные ванильные механики.
* Утилиты, размещенные в shared директории, разработаны таким образом, что могут быть легко использованы в других модах. Нет необходимости копировать куски кода, просто вызывайте сами функции из этих библиотек.
* Исправления некоторых игровых багов.
* Множество мелких (и не очень) улучшений интерфейса, повышающих удобство игрового процесса и администрирования.
* Перераспределение ролевой модели, позволяющее GM и Модераторам использовать часть возможностей, ранее доступных только Администраторам.
* Все улучшения, представленные в этом моде, могут быть выключены в настройках песочницы. Они не требуют перезапуска сервера, а большинство из них не требуют и перезапуска клиента.

## Server Sandbox Options
* **SaveClientOptions** `(default=true)` - добавляет в игру сохранение настроек, которые доступны в меню клиента. Там находятся переключатели для отображения текста в правом нижнем углу экрана. Можно настроить отображение, и игра запомнит сделанный выбор. В оригинальной игре эти настройки сбрасываются после перезапуска игры на клиенте.
* **AddClientCache** `(default=true)` - добавляет в игру кеширование некоторых часто запрашиваемых данных. Например, для того чтобы отобразить SafeHouse игрока, происходит полный перебор всех убежищ на сервере, что может вызывать просадку FPS. Включение этой опции позволяет держать SafeHouse игрока всегда "под рукой" и избежать полного перебора. Список кешируемых данных будет пополняться.
* **AllowAdminToolsForGM** `(default=true)` - позволяет игрокам с уровнем доступа GM использовать инструменты из контекстного меню администратора. Доступны покраска машин, удаление трупов и предметов с земли, возможность призывать гром и шум. Также для ролей GM и Moderator добавляет возможность выполнять телепорты через клик в интерфейсе отображения карты мира (M). 
* **DisallowSpawnItemsForObservers** `(default=false)` - запрещает для Observer спавнить предметы.
* **DisableAimOutline** `(default=false)` - позволяет принудительно отключить игрокам контур по цели. Включать эту настройку не рекомендуется, так как она выключает контур в настройках игрока. Игроку нужно будет самостоятельно заходить в настройки и возвращать контур, если он хочет его использовать в одиночной игре или на другом сервере.
* **DisableTradeWithPlayers** `(default=false)` - позволяет отключить интерфейс торговли с игроками. Настройка добавлена, потому что в оригинальной игре существует несколько багов, связанных с интерфейсом торговли. Например, через него можно передавать неограниченное количество вещей, чем значительно превышать лимит максимально допустимого переносимого веса. Настройка отключена по умолчанию, но ее рекомендуется включить.
* **ProtectVehicleInSafehouse** `(default=false)` - защищает машины, полностью или частично находящиеся в убежище. Для персонажа, не являющегося участником убежища, скрыто радиальное меню этих машин и отключены возможности сесть в машину и открыть меню механики. Также такие машины невозможно подцепить другим автомобилем. В оригинальной игре такие машины часто угоняют или с них скручивают детали, что вызывает дискомфорт на PVE серверах. Включение этой настройки позволит улучшить этот пользовательский опыт.
* **ScreenBlackoutOnDeath** `(default=true)` - затемняет экран после смерти персонажа. В оригинальной игре после смерти игроку остается доступным видеть происходящее возле персонажа. На PVP серверах это может абьюзиться для координации игроков во фракции, подсвечивая таким образом перемещения соперников. Также после смерти персонаж перестает быть объектом класса Player и лишается части его ограничений. В частности он начинает видеть стоящих рядом невидимых администраторов сервера. Затемнение экрана является фиксом этих ошибок.
* **HighlightSafehouse** `(default=true)` - показывает игроку территорию его убежища. Если опция **HighlightSafehouse** включена в настройках песочницы сервера, то игроку становится доступна такая же настройка в настройках клиента. Каждый игрок сможет сам для себя выбрать подсвечивать территорию или нет.
* **TweakFirearmsSoundRadius** `(default=false)` - возвращает огнестрельному оружию параметры радиуса звука к показателям 41.56 билда. Подробнее в [Reddit](https://www.reddit.com/r/projectzomboid/comments/ref3if/b4160_weapos_changes_guns_sound_radius).
* **SetGeneralChatStreamAsDefault** `(default=false)` - устанавливает чат General (/all) чатом по умолчанию. В оригинальной игре открывается локальный чат (/say) и некоторые не опытные игроки могут испытывать трудности с поиском того, как писать в общий чат.
* **DisplayCharacterCoordinates** `(default=true)` - добавляет в интерфейс просмотра персонажа (J) отображение его координат. У игрока должны быть в инвентаре любые часы, отображающие дату.
* **AddSatelliteViewToMap** `(default=true)` - позволяет игрокам включать режим отображения вида карты "со спутника". Отображение становится близким к тому, которое находится на [онлайн карте](https://map.projectzomboid.com).
* **DisplaySafehouseAreaSize** `(default=true)` - в интерфейсе просмотра убежища игрока показывает площадь убежища я в тайлах.
* **CustomSafezoneAdminTweaks** `(default=true)` - включает сразу несколько правок в интерфейсе создания произвольного убежища. 
  - в оригинальной игре такое убежище может создавать только Administrator - после включения этой опции создание станет доступным для Moderator.
  - снимает ограничение на минимальный размер произвольного убежища - становится доступным создавать убежище, размером 1x1 тайлов.
  - в интерфейсе создания произвольного убежища добавляется дополнительное поле, в котором через запятую можно перечислить всех участников убежища.
  - исправляет подсчет площади убежища, которая отображается при создании произвольного убежища.
* **TweakOverlayText** `(default=true)` - комплексно модифицирует текст, который отображается в правом нижнем углу:
  - при посещении PVE территории отображается зеленая надпись с текстом "ВЫ НАХОДИТЕСЬ В ЗОНЕ БЕЗ PVP".
  - строки с информацией о сервере объединяются в одну более компактную и информативную.
* **PinOverlayServerInfoText** `(default=true)` - отдельная настройка, блокирующая для игроков возможность изменения переключателей "Show connection info" и "Show server info" в настройках клиента. Переключатель отображения пинга остается доступным и его положение запоминается игрой при перезапусках.
* **HideServerOptionsFromPlayers** `(default=true)` - отдельная настройка, блокирующая для игроков возможность посмотреть настройки сервера в настройках клиента.

## Compatibility
Версия игры: Build 41.78+ (Multiplayer)  
В моде практически нет грубого патчинга с полной заменой кода ванильных функций поэтому предполагается хорошая совместимость со всеми модами из мастерской. Мод полностью совместим с существующим сохранением и безопасен для удаления.

## Translations
Мод переведен на следующие языки:  

* English (EN)
* Russian (RU)
* Thai (TH) - Спасибо [rikoprushka](https://github.com/rikoprushka)
* Brazilian Portuguese (PTBR) - Спасибо [Xim](https://steamcommunity.com/id/BryanXim)

Если вы хоите перевести мод на свой язык, поместите его в [разделе переводов](https://steamcommunity.com/workshop/filedetails/discussion/2951816996/3824159062924268441) и я добавлю перевод.

## License
MIT License, see [LICENCE](LICENSE)  
